(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[959],{148:(e,s,a)=>{Promise.resolve().then(a.bind(a,6728))},646:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},2523:(e,s,a)=>{"use strict";a.d(s,{p:()=>n});var t=a(5155),l=a(2115),r=a(9434);let n=l.forwardRef((e,s)=>{let{className:a,type:l,...n}=e;return(0,t.jsx)("input",{type:l,className:(0,r.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),ref:s,...n})});n.displayName="Input"},5169:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5695:(e,s,a)=>{"use strict";var t=a(8999);a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}})},6728:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>g});var t=a(5155),l=a(2115),r=a(5695),n=a(8860),i=a(6681),c=a(8497),d=a(285),m=a(6695),x=a(2523),h=a(1154),o=a(2919),u=a(5339),p=a(646),b=a(5169),j=a(3227);let f=(0,a(9946).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function g(){let e=(0,r.useRouter)(),[s,a]=(0,l.useState)({name:"",description:""}),[g,N]=(0,l.useState)({}),[y,v]=(0,l.useState)(!1),{isLoggedIn:w,loading:k}=(0,i.A)(),{isAdmin:A,getPermissionErrorMessage:P}=(0,c.S)(),C=(0,n.q$)(),S=async a=>{if(a.preventDefault(),(()=>{let e={};return s.name.trim()?s.name.length<2?e.name="組織名は2文字以上で入力してください":s.name.length>100&&(e.name="組織名は100文字以内で入力してください"):e.name="組織名は必須です",/[<>'"]/.test(s.name)&&(e.name="組織名に使用できない文字が含まれています"),N(e),0===Object.keys(e).length})())try{await C.mutateAsync({name:s.name.trim()}),v(!0),setTimeout(()=>{e.push("/dashboard/organizations")},2e3)}catch(e){var t,l,r;(null==(t=e.response)?void 0:t.status)===409?N({name:"この組織名は既に使用されています"}):(null==(l=e.response)?void 0:l.status)===400?N({form:(null==(r=e.response.data)?void 0:r.message)||"入力内容に誤りがあります"}):N({form:"組織の作成に失敗しました。もう一度お試しください。"})}},z=(e,s)=>{a(a=>({...a,[e]:s})),g[e]&&N(s=>{let a={...s};return delete a[e],a})};return k?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(h.A,{className:"h-6 w-6 animate-spin"}),(0,t.jsx)("span",{children:"認証情報を確認中..."})]})}):w?A()?y?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsx)(m.Zp,{className:"p-8 max-w-md w-full",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(p.A,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"組織を作成しました"}),(0,t.jsxs)("p",{className:"text-gray-600 mb-6",children:["組織「",s.name,"」を正常に作成しました。"]}),(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,t.jsx)(h.A,{className:"h-4 w-4 animate-spin"}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"組織一覧にリダイレクトしています..."})]})]})})}):(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900",children:(0,t.jsxs)("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)(d.$,{onClick:()=>e.push("/dashboard/organizations"),variant:"outline",className:"mb-4 flex items-center space-x-2",children:[(0,t.jsx)(b.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"組織一覧に戻る"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"bg-blue-500/20 p-3 rounded-lg",children:(0,t.jsx)(j.A,{className:"h-8 w-8 text-blue-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-white",children:"新しい組織を作成"}),(0,t.jsx)("p",{className:"text-gray-300 mt-1",children:"組織を作成して、メンバーを招待しましょう"})]})]})]}),(0,t.jsx)(m.Zp,{className:"p-8 bg-white/10 backdrop-blur-sm border border-white/20",children:(0,t.jsxs)("form",{onSubmit:S,className:"space-y-6",children:[g.form&&(0,t.jsx)("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,t.jsx)(f,{className:"h-5 w-5 text-red-400 mt-0.5"}),(0,t.jsx)("p",{className:"text-sm text-red-300",children:g.form})]})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-white mb-2",children:["組織名 ",(0,t.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,t.jsx)(x.p,{id:"name",type:"text",value:s.name,onChange:e=>z("name",e.target.value),placeholder:"例: 株式会社サンプル",className:"bg-white/10 border-white/30 text-white placeholder:text-gray-400 ".concat(g.name?"border-red-500":""),disabled:C.isPending,autoFocus:!0}),g.name&&(0,t.jsx)("p",{className:"mt-2 text-sm text-red-400",children:g.name}),(0,t.jsx)("p",{className:"mt-2 text-xs text-gray-400",children:"2〜100文字で入力してください"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"description",className:"block text-sm font-medium text-white mb-2",children:["説明 ",(0,t.jsx)("span",{className:"text-gray-400",children:"（任意）"})]}),(0,t.jsx)("textarea",{id:"description",value:s.description,onChange:e=>z("description",e.target.value),placeholder:"組織の説明を入力してください",rows:4,className:"w-full px-3 py-2 bg-white/10 border border-white/30 rounded-lg text-white placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:C.isPending})]}),(0,t.jsxs)("div",{className:"flex space-x-4 pt-4",children:[(0,t.jsx)(d.$,{type:"submit",disabled:C.isPending||!s.name.trim(),className:"flex-1 flex items-center justify-center space-x-2",children:C.isPending?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.A,{className:"h-4 w-4 animate-spin"}),(0,t.jsx)("span",{children:"作成中..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"組織を作成"})]})}),(0,t.jsx)(d.$,{type:"button",variant:"outline",onClick:()=>e.push("/dashboard/organizations"),disabled:C.isPending,className:"flex-1",children:"キャンセル"})]})]})}),(0,t.jsxs)("div",{className:"mt-8 p-6 bg-blue-500/10 rounded-lg border border-blue-500/30",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-blue-300 mb-2",children:"組織作成についての注意事項"}),(0,t.jsxs)("ul",{className:"space-y-1 text-sm text-gray-300",children:[(0,t.jsx)("li",{children:"• 組織を作成すると、あなたが自動的にオーナーになります"}),(0,t.jsx)("li",{children:"• 組織名は後から変更することができます"}),(0,t.jsx)("li",{children:"• 作成後、メンバーを招待して共同作業を開始できます"}),(0,t.jsx)("li",{children:"• 1つのアカウントで複数の組織を作成・管理できます"})]})]})]})}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsx)(m.Zp,{className:"p-8 max-w-md w-full",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(u.A,{className:"h-12 w-12 text-amber-500 mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"アクセス権限がありません"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:P("admin")}),(0,t.jsx)(d.$,{onClick:()=>e.push("/dashboard"),variant:"outline",className:"w-full",children:"ダッシュボードに戻る"})]})})}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsx)(m.Zp,{className:"p-8 max-w-md w-full",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(o.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"ログインが必要です"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:P()}),(0,t.jsx)(d.$,{onClick:()=>e.push("/login"),className:"w-full",children:"ログインページへ"})]})})})}}},e=>{e.O(0,[212,967,426,325,441,964,358],()=>e(e.s=148)),_N_E=e.O()}]);