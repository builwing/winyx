"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[148],{3227:(e,t,r)=>{r.d(t,{A:()=>s});let s=(0,r(9946).A)("building-2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},6126:(e,t,r)=>{r.d(t,{E:()=>o});var s=r(5155);r(2115);var a=r(4624),l=r(2085),n=r(9434);let i=(0,l.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:r,asChild:l=!1,...o}=e,c=l?a.DX:"span";return(0,s.jsx)(c,{"data-slot":"badge",className:(0,n.cn)(i({variant:r}),t),...o})}},6681:(e,t,r)=>{r.d(t,{A:()=>l});var s=r(2115),a=r(7283);let l=()=>{let[e,t]=(0,s.useState)(!1),[r,l]=(0,s.useState)(null),[n,i]=(0,s.useState)(null),[o,c]=(0,s.useState)(!0),[d,h]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{h(!0);try{let e=localStorage.getItem("access_token"),r=localStorage.getItem("user");if(e&&(i(e),t(!0),a.A.setAuthToken(e),r))try{l(JSON.parse(r))}catch(e){console.error("Failed to parse stored user data:",e),localStorage.removeItem("user")}}catch(e){console.warn("localStorage not available:",e)}c(!1)},[]),d)?{isLoggedIn:e,user:r,token:n,loading:o,login:async(e,r)=>{try{let s=await fetch("/api/v1/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r})});if(!s.ok)throw Error("ログインに失敗しました");let n=(await s.json()).access_token;localStorage.setItem("access_token",n),i(n),t(!0),a.A.setAuthToken(n);let o={id:1,name:e.split("@")[0],email:e,roles:["admin"]};return localStorage.setItem("user",JSON.stringify(o)),l(o),{success:!0}}catch(e){return console.error("Login error:",e),{success:!1,error:e instanceof Error?e.message:"ログインに失敗しました"}}},logout:()=>{localStorage.removeItem("access_token"),localStorage.removeItem("user"),i(null),l(null),t(!1),a.A.clearAuthToken()}}:{isLoggedIn:!1,user:null,token:null,loading:!0,login:async()=>({success:!1,error:"Not hydrated"}),logout:()=>{}}}},7148:(e,t,r)=>{r.d(t,{A:()=>w});var s=r(5155),a=r(2115),l=r(6874),n=r.n(l),i=r(6681),o=r(8497),c=r(6126),d=r(9946);let h=(0,d.A)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);var u=r(7580),x=r(3227);let m=(0,d.A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),p=(0,d.A)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]),f=(0,d.A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),v=(0,d.A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),b=(0,d.A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),g=(0,d.A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),y=(0,d.A)("menu",[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]]);function w(){var e;let[t,r]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!1),{user:w,logout:j}=(0,i.A)(),{isAdmin:k,userRoles:N}=(0,o.S)(),A=[{href:"/dashboard",label:"ダッシュボード",icon:h,description:"システム監視"},{href:"/users",label:"ユーザー管理",icon:u.A,description:"ユーザーCRUD",adminOnly:!0},{href:"/dashboard/organizations",label:"組織管理",icon:x.A,description:"組織設定",adminOnly:!0}].filter(e=>!e.adminOnly||k());return(0,s.jsx)("header",{className:"bg-white/10 backdrop-blur-md border-b border-white/20 sticky top-0 z-50",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,s.jsx)("div",{className:"flex items-center space-x-4",children:(0,s.jsxs)(n(),{href:"/dashboard",className:"flex items-center space-x-3 text-white hover:text-blue-300 transition-colors",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:(0,s.jsx)(m,{className:"w-5 h-5 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-bold",children:"Winyx Admin"}),(0,s.jsx)("p",{className:"text-xs text-blue-300",children:"管理コンソール"})]})]})}),(0,s.jsx)("nav",{className:"hidden md:flex items-center space-x-1",children:A.map(e=>{let t=e.icon;return(0,s.jsxs)(n(),{href:e.href,className:"group relative px-4 py-2 rounded-xl text-white/80 hover:text-white hover:bg-white/10 transition-all duration-200 flex items-center space-x-2",children:[(0,s.jsx)(t,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"font-medium",children:e.label}),(0,s.jsxs)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-1 bg-gray-900 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap",children:[e.description,(0,s.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]},e.href)})}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)(n(),{href:"/",className:"hidden sm:inline-flex items-center px-3 py-2 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-white hover:text-blue-300 transition-all duration-200",children:[(0,s.jsx)(p,{className:"w-4 h-4 mr-2"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"ホーム"})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("button",{onClick:()=>d(!l),className:"flex items-center space-x-3 px-4 py-2 bg-white/10 hover:bg-white/20 border border-white/20 rounded-xl text-white transition-all duration-200",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-sm font-bold text-white",children:(null==w||null==(e=w.name)?void 0:e.charAt(0).toUpperCase())||"U"})}),(0,s.jsxs)("div",{className:"hidden sm:block text-left",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:(null==w?void 0:w.name)||"ユーザー"}),(0,s.jsx)("div",{className:"flex items-center space-x-1",children:N.map(e=>(0,s.jsx)(c.E,{variant:"secondary",className:"text-xs px-1 py-0 bg-blue-500/20 text-blue-300 border-blue-500/30",children:e},e))})]})]}),(0,s.jsx)(f,{className:"w-4 h-4 transition-transform duration-200 ".concat(l?"rotate-180":"")})]}),l&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-64 bg-white/10 backdrop-blur-md border border-white/20 rounded-xl shadow-xl py-2",children:[(0,s.jsxs)("div",{className:"px-4 py-3 border-b border-white/10",children:[(0,s.jsx)("p",{className:"text-sm text-white font-medium",children:null==w?void 0:w.name}),(0,s.jsx)("p",{className:"text-xs text-gray-300",children:null==w?void 0:w.email}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:N.map(e=>(0,s.jsx)(c.E,{variant:"secondary",className:"text-xs bg-blue-500/20 text-blue-300 border-blue-500/30",children:e},e))})]}),(0,s.jsxs)("div",{className:"py-2",children:[(0,s.jsxs)("button",{onClick:()=>{d(!1)},className:"w-full px-4 py-2 text-left text-white hover:bg-white/10 flex items-center space-x-2 transition-colors",children:[(0,s.jsx)(v,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"設定"})]}),(0,s.jsxs)("button",{onClick:()=>{d(!1),j(),window.location.href="/login"},className:"w-full px-4 py-2 text-left text-red-300 hover:bg-red-500/10 flex items-center space-x-2 transition-colors",children:[(0,s.jsx)(b,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"ログアウト"})]})]})]})]}),(0,s.jsx)("button",{onClick:()=>r(!t),className:"md:hidden p-2 text-white hover:bg-white/10 rounded-lg transition-colors",children:t?(0,s.jsx)(g,{className:"w-6 h-6"}):(0,s.jsx)(y,{className:"w-6 h-6"})})]})]}),t&&(0,s.jsx)("div",{className:"md:hidden border-t border-white/20 py-4",children:(0,s.jsxs)("nav",{className:"space-y-2",children:[A.map(e=>{let t=e.icon;return(0,s.jsxs)(n(),{href:e.href,onClick:()=>r(!1),className:"flex items-center space-x-3 px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-xl transition-all duration-200",children:[(0,s.jsx)(t,{className:"w-5 h-5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:e.label}),(0,s.jsx)("p",{className:"text-xs text-gray-300",children:e.description})]})]},e.href)}),(0,s.jsxs)(n(),{href:"/",onClick:()=>r(!1),className:"flex items-center space-x-3 px-4 py-3 text-white/80 hover:text-white hover:bg-white/10 rounded-xl transition-all duration-200",children:[(0,s.jsx)(p,{className:"w-5 h-5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:"ホームページ"}),(0,s.jsx)("p",{className:"text-xs text-gray-300",children:"メインサイトへ"})]})]})]})})]})})}},7283:(e,t,r)=>{r.d(t,{A:()=>a});class s{async request(e,t,r){let s="".concat(this.baseUrl).concat(t);this.updateAuthToken();let a={method:e,headers:{...this.headers}};r&&(a.body=JSON.stringify(r));try{let e=await fetch(s,a);if(!e.ok)throw Error("API Error: ".concat(e.status," ").concat(e.statusText));let t=e.headers.get("content-type");if(t&&t.includes("application/json"))return e.json();return e.text()}catch(e){throw console.error("API Request failed:",e),e}}async get(e){return this.request("GET",e)}async post(e,t){return this.request("POST",e,t)}async put(e,t){return this.request("PUT",e,t)}async delete(e){return this.request("DELETE",e)}updateAuthToken(){if("undefined"!=typeof localStorage)try{let e=localStorage.getItem("access_token");e?this.headers.Authorization="Bearer ".concat(e):delete this.headers.Authorization}catch(e){console.warn("Could not access localStorage:",e),delete this.headers.Authorization}}setAuthToken(e){this.headers.Authorization="Bearer ".concat(e)}clearAuthToken(){delete this.headers.Authorization}constructor(e){this.baseUrl=e,this.headers={"Content-Type":"application/json",Accept:"application/json"}}}let a=new s("https://winyx.jp")},7580:(e,t,r)=>{r.d(t,{A:()=>s});let s=(0,r(9946).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},8497:(e,t,r)=>{r.d(t,{S:()=>a});var s=r(6681);let a=()=>{let{user:e,isLoggedIn:t}=(0,s.A)();return{isAdmin:()=>!!t&&!!e&&!!e.roles&&e.roles.includes("admin"),hasRole:r=>!!t&&!!e&&!!e.roles&&e.roles.includes(r),hasAnyRole:r=>!!t&&!!e&&!!e.roles&&r.some(t=>e.roles.includes(t)),hasAllRoles:r=>!!t&&!!e&&!!e.roles&&r.every(t=>e.roles.includes(t)),getPermissionErrorMessage:e=>t?e?"このページにアクセスするには「".concat(e,"」権限が必要です。"):"このページにアクセスする権限がありません。":"このページにアクセスするにはログインが必要です。",userRoles:(null==e?void 0:e.roles)||[]}}},9434:(e,t,r)=>{r.d(t,{cn:()=>l});var s=r(2596),a=r(9688);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},9946:(e,t,r)=>{r.d(t,{A:()=>o});var s=r(2115);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},l=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:h,...u}=e;return(0,s.createElement)("svg",{ref:t,...n,width:a,height:a,stroke:r,strokeWidth:o?24*Number(i)/Number(a):i,className:l("lucide",c),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(u)&&{"aria-hidden":"true"},...u},[...h.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let r=(0,s.forwardRef)((r,n)=>{let{className:o,...c}=r;return(0,s.createElement)(i,{ref:n,iconNode:t,className:l("lucide-".concat(a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),o),...c})});return r.displayName=a(e),r}}}]);